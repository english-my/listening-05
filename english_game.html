<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è‹±èªä¸¦ã¹æ›¿ãˆã‚¯ã‚¤ã‚ºï¼ˆã‚¹ãƒãƒ›å¯¾å¿œãƒ»å®Œå…¨ç‰ˆï¼‰</title>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      margin: 0;
      background: #ffffff;
    }
    h2 {
      text-align: center;
    }
    ul {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      padding: 0;
      margin: 10px auto;
      list-style: none;
      justify-content: center;
      max-width: 90vw;
    }
    li {
      padding: 10px 14px;
      background: #e0f7fa;
      border: 1px solid #aaa;
      border-radius: 5px;
      font-size: 16px;
      cursor: grab;
      word-break: break-word;
    }
    .correct {
      background-color: #a5d6a7 !important;
    }
    .incorrect {
      background-color: #ef9a9a !important;
    }
    button {
      font-size: 16px;
      padding: 12px 20px;
      margin: 15px auto;
      background-color: #ffd54f;
      border: none;
      border-radius: 8px;
      color: #333;
      display: block;
      width: 90%;
      max-width: 320px;
    }
    #correctAnswer {
      font-weight: bold;
      color: #2e7d32;
      text-align: center;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h2 id="questionTitle">ğŸ§© è‹±æ–‡ä¸¦ã¹æ›¿ãˆã‚¯ã‚¤ã‚ºï¼ˆ1å•ç›®ï¼‰</h2>
<ul id="wordBank"></ul>
<p id="correctAnswer"></p>

<button onclick="playAudio()">â–¶ éŸ³å£°ã‚’å†ç”Ÿã™ã‚‹</button>
<button onclick="nextQuestion()" id="nextBtn" style="display:none;">â¡ æ¬¡ã®å•é¡Œã¸</button>

<audio id="voicePlayer">
  <source id="audioSource" src="" type="audio/mpeg">
</audio>
<audio id="successSound">
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_48d1e2009a.mp3" type="audio/mpeg">
</audio>

<script>
const sentences = [
  "Could you tell me where the meeting room is? I need to join the meeting in 5 minutes.",
  "Please take this file to Mr. Johnson's office. Itâ€™s urgent and heâ€™s waiting for it now.",
  "Can you show me how to use this machine? Iâ€™ve never operated it before.",
  "I need you to send the email before noon. The client is expecting a reply by then.",
  "Did you bring the documents I asked for? They are important for todayâ€™s meeting.",
  "Please write your name on the top of the paper. It helps us keep track of submissions.",
  "Could you help me carry this box? Itâ€™s heavier than I thought it would be.",
  "Tell him to call me when he gets back. I need to discuss something important with him.",
  "Did she show you how to complete the task? If not, I can walk you through it.",
  "Can you remind me to call the client later? I donâ€™t want to forget it again."
];

let current = 0;
let sortableInstance = null;

function loadQuestion(index) {
  const wordBank = document.getElementById("wordBank");
  wordBank.innerHTML = "";
  document.getElementById("nextBtn").style.display = "none";
  document.getElementById("correctAnswer").textContent = "";
  document.getElementById("questionTitle").innerText = `ğŸ§© è‹±æ–‡ä¸¦ã¹æ›¿ãˆã‚¯ã‚¤ã‚ºï¼ˆ${index + 1}å•ç›®ï¼‰`;

  const sentence = sentences[index];
  const words = sentence.split(" ");
  const shuffled = [...words].sort(() => Math.random() - 0.5);

  for (let word of shuffled) {
    const li = document.createElement("li");
    li.textContent = word;
    wordBank.appendChild(li);
  }

  // æ—¢å­˜ã®Sortableã‚’ç ´æ£„ã—ã¦ã‹ã‚‰å†åˆæœŸåŒ–
  if (sortableInstance) {
    sortableInstance.destroy();
  }

  sortableInstance = new Sortable(wordBank, {
    animation: 150,
    onSort: function () {
      checkCompletion();
    }
  });

  const audio = document.getElementById("audioSource");
  audio.src = `5-${index + 1}.mp3`;
  document.getElementById("voicePlayer").load();
}

function checkCompletion() {
  const slots = document.querySelectorAll("#wordBank li");
  const currentSentence = sentences[current].split(" ");
  let correct = true;

  slots.forEach((slot, i) => {
    if (slot.textContent === currentSentence[i]) {
      slot.classList.add("correct");
      slot.classList.remove("incorrect");
    } else {
      slot.classList.add("incorrect");
      slot.classList.remove("correct");
      correct = false;
    }
  });

  if (correct && slots.length === currentSentence.length) {
    document.getElementById("correctAnswer").textContent = "ğŸ‰ æ­£è§£ã§ã™ï¼";
    document.getElementById("nextBtn").style.display = "block";
    document.getElementById("successSound").play();
  } else {
    document.getElementById("nextBtn").style.display = "none";
  }
}

function playAudio() {
  document.getElementById("voicePlayer").play();
}

function nextQuestion() {
  current++;
  if (current < sentences.length) {
    loadQuestion(current);
  } else {
    document.body.innerHTML = "<h2 style='text-align:center;'>ğŸ‰ å…¨å•çµ‚äº†ï¼ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼</h2>";
  }
}

loadQuestion(current);
</script>
</body>
</html>
